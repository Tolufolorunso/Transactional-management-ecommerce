<% layout('layouts/boilerplate') %>
<section class="cart" style="background-color: #f5f5f5">
  <div class="container pb-5">
    <% if(carts.length > 0) { %>
    <div class="row pt-md-4">
      <div class="col-md-7">Item</div>
      <div class="col-md-1 text-center">QUANTITY</div>
      <div class="col-md-2 text-center">UNIT PRICE</div>
      <div class="col-md-2 text-center">SUBTOTAL</div>
    </div>
    <% carts.forEach(p => { %>
    <div class="row pb-md-2">
      <div class="card mb-3" style="width: 100%">
        <div class="row">
          <div class="col-md-1">
            <img src="<%= p.title %>" class="img-fluid rounded-start" alt="<%= p.title %> " />
          </div>
          <div class="col-md-6 border-end">
            <p>Seller: <span class="fs-6"><%= currentUser.name %> </span></p>
            <div class="card-bod">
              <h5 class="card-title"><%= p.productId.title %></h5>
              <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
              <div>
                <form action="/cart/<%= p.productId._id %>?_method=DELETE" method="post">
                  <button type="submit" class="btn btn-link text-decoration-none" id="clear-cart">
                    Remove
                  </button>
                </form>
              </div>
            </div>
          </div>
          <div class="col-md-1 text-center border-end pt-3">
            <input type="hidden" name="id" value="<%= p.productId._id %>" id="product-id" />
            <input
              type="number"
              name="quantity"
              value="<%= p.quantity %>"
              id="quantity"
              class="form-control border-1 border-end-0 border-top-0 border-start-0 text-center quantity"
              min="1"
              max="20"
            />
          </div>
          <div class="col-md-2 text-center border-end pt-3">30</div>
          <div class="col-md-2 text-center pt-3">300</div>
        </div>
      </div>
    </div>

    <% }) %>
    <form action="/clear-cart?_method=DELETE" method="post">
      <button type="submit" id="clear-cart">Clear Carts</button>
    </form>
    <% } else { %>
    <div class="row p-4 empty-cart">
      <div class="col-12">
        <p class="fw-bold display-1">Cart</p>
      </div>
      <div class="empty-cart__content">
        <div class="cart-logo"><i class="fas fa-cart-plus fa-2x"></i></div>
        <p class="lead text-muted">Nothing in the Cart. start to shop</p>
        <% if(!currentUser) {%>
        <p class="lead text-muted">
          Already have an account? <a href="/login" class="text-warning text-decoration-none">Login</a> to see
          the items in your cart.
        </p>
        <% } %>
        <a href="/products" class="btn btn-warning text-capitalize">start shopping</a>
      </div>
    </div>
    <% } %>
  </div>
</section>
